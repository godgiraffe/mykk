# Bybit 指數價格機制的設計漏洞與改進方案

> **來源**: [@sunlc_crypto](https://x.com/sunlc_crypto/status/1911934814309269988)
>
> **日期**: 
>
> **標籤**: `指數計算` `市場操縱風險` `風控機制`

---

## 事件背景與時間線

2025年4月8日至4月14日期間，Bybit ZEC/USDT 合約的指數價格出現異常波動，涉及幣安(Binance)交易所價格源的多次自動剔除與重入，以及平台的人工參數調整。

### 完整時間軸

- **2025-04-08 03:13 UTC**：幣安 ZEC 價格在5%偏離閾值附近反覆抖動，導致幣安價格源時而被剔除、時而被加回。為穩定指數價格，Bybit 風控將偏離閾值從5%手動提升至10%。

- **2025-04-13 03:54 UTC**：幣安 ZEC 價格觸發10%偏離閾值，成分被自動剔除。

- **2025-04-13 04:32 UTC**：幣安 ZEC 偏離比例在10%徘徊，短暫重入後再次被剔除。

- **2025-04-14 01:58 UTC**：幣安自動重入指數成分。

- **2025-04-14 08:04 UTC**：幣安短暫自動剔除後又自動重入。

- **2025-04-14 08:49 UTC**：鑒於幣安頻繁剔除/重入，Bybit 將幣安成分權重上限設置為50%。

- **2025-04-14 09:12 UTC**：幣安短暫剔除後重入。

- **2025-04-14 09:28 UTC**：Bybit 風控將 ZECUSDT 中位數偏離閾值從10%調整至20%，並生效至今。

## 指數價格機制的四大問題

### 1. 指數價格剔除規則不合理

Bybit 目前採用固定閾值(5%或10%)來控制價格源的剔除與準入。這套規則在99%的情況下可行，但當面對 ZEC 這種交易所較少且某個交易所佔絕對大頭的交易對時，一旦該交易所出現問題，簡單粗暴的閾值機制就會失效。

**建議改進方案**：採用更線性平滑的方式處理權重調整：
- 當偏離超過5%時，幣安的權重 × 0.8
- 超過10%時 × 0.5
- 超過15%時 × 0.3

對於已經剔除(或降權)的交易所，重新加入時應有更嚴格的標準(或人工審核)，而不是採用同一個閾值。否則就會被有心人惡意操控並大幅影響市場。

**ZEC 事件實例**：在幣安被剔除後,整個指數價格完全由 MEXC 控制，而控制 MEXC 的現貨價格可能只需要幾萬美元成本。這個機制上的漏洞是造成本次問題的主因。

### 2. 參數調整過程業餘且缺乏預案

在與 Bybit 技術人員溝通中得知，Bybit 其實知道這個問題。之前系統有相關的處理邏輯但後來不知為何被移除。當這次再出現問題後，嘗試通過手工調整成10%閾值來解決，沒想到調整後繼續被人操控，又調整成50%。

整個過程顯得相當業餘，完全沒考慮過這樣的調整會對價格產生10%以上的直接影響。用一個又一個的錯誤去彌補前面的錯誤。

### 3. 無法排除內部人員利用信息差獲利的可能性

整個人工調整參數的過程，雖然可以排除 Bybit 官方做惡，但沒有辦法排除其中某個工作人員利用漏洞和信息差獲利的可能性。

### 4. 缺乏透明的指數調整查詢機制

目前指數價格的調整和組成並沒有直接的方式可以獲知。就算沒有公告，至少應該有 API 接口可以查到。否則對於量化交易的用戶來說就是兩眼一抹黑，當後台調整參數後，直接反應在價格上時用戶已經嚴重虧損。

**建議**：應該有像資金費率一樣的接口來進行預告。

## Bybit 官方回應說明

### 指數計算規則總結

Bybit 指數價格取自多家交易所，根據指數成分的交易量實時計算權重，加權平均得到平台指數。當某一成分價格出現跳變或價格偏離時，系統會進行自動化調整。當系統的自動調整過於頻繁，或指數成分反覆橫跳時，風控會手動調整部分參數，目的是確保價格平滑。

### 自動化調整機制

- 指數成分偏離中位數超過5%，觸發自動剔除機制
- 指數成分偏離中位數比例小於5%，觸發自動重入機制
- 所有調整都有完整的工作流留檔，人工調整是基於市場情況做出保護用戶的決策

## 作者背景與建議

作者具有10多年銀行核心系統的開發和設計經驗，曾參與工商銀行核心系統和平安銀行核心交易系統的設計。認為任何一家專業的金融機構，都不會採用如此簡單粗暴的方式調整一個對市場有重大影響的參數。

Bybit 作為目前行業前三的龍頭，不應該存在這樣大的問題。作者表示可以從專業量化用戶的角度，配合 Bybit 產品部門一起探討如何更合理地優化解決目前的問題，之前曾幫助過 OKX 討論系統設計上的漏洞。
