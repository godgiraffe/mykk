# Pendle 收益代幣化協議完全指南

> **來源**: [@Dapp_Learning](https://x.com/Dapp_Learning/status/1934884944859549993) | [原文連結](https://hackmd.io/ED2ceL7zT5-tP94JlEXmWg)
>
> **日期**: 
>
> **標籤**: `Pendle` `收益交易` `DeFi 策略`

---

我來協助你整理這篇關於 Pendle 收益代幣化協議的文章。

## 概述

Pendle 是一個創新的 DeFi 協議，專注於**收益代幣化（Yield Tokenization）**和**收益交易（Yield Trading）**，也可以理解為一種「收益期貨市場」。簡單來說，Pendle 允許用戶將其質押資產未來的收益分離出來進行交易，從而實現更靈活的收益管理和投機。

在 Pendle 中，質押資產被拆分為兩種代幣：

| 類型 | 名稱 | 功能 |
|------|------|------|
| **PT (Principal Token)** | 本金代幣 | 代表原始資產本身，到期時可贖回全部本金 |
| **YT (Yield Token)** | 收益代幣 | 代表未來到期前可獲得的收益（如質押獎勵、利息等） |

### 舉例說明

如果你持有 stETH，你可以通過 Pendle 把它拆成：
- **PT-stETH**：本金（代表 stETH 本身）
- **YT-stETH**：收益（未來某段時間內這部分 stETH 產生的利息）

## 核心功能

### 1. 收益分離（Yield Tokenization）

任何支持的質押資產都可以拆成 PT + YT 兩部分。

### 2. 收益交易（Yield Trading）

- **買入 YT**：你可以「賭」收益會上升，從而獲得更高年化收益（APY）
- **賣出 YT**：你可以鎖定當前收益（相當於提前「兌現」收益）

### 3. 流動性提供（LP Farming）

Pendle 為 PT 和 YT 分別開設 AMM（自動做市商）市場，LP 可以賺取交易費和激勵。

### 4. 到期贖回

到期後，PT 持有者可贖回本金，YT 歸零。

## SY (標準化收益代幣)

在 DeFi 生態中，不同的收益資產有不同的結構，比如：
- stETH 的利息是以質押形式持續增長
- Aave 的 aToken 利息是餘額自動增長
- LP Token 的收益來自手續費

這些資產的收益形式不一樣，Pendle 無法直接處理所有這些「原生資產」，所以需要一個統一的接口——這就是 **SY (Standardized Yield)**。

## Minting（鑄造）

在 Pendle 中，minting 就是把你持有的質押資產（如 stETH、aUSDC、LP Token 等）「拆解」為 PT 和 YT 的過程。

### 舉例說明

假設你有 100 stETH，你進行 mint 操作後，可能會得到：
- 100 PT-stETH-28DEC2025（代表你可以在 2025 年 12 月 28 日贖回這 100 個 stETH）
- 100 YT-stETH-28DEC2025（代表你擁有這段時間內產生的收益）

圖中舉的例子是 Mint DAI，可以看到 Mint 結束之後用戶會收到對應的 PT 和 YT。YT 持有過程中將會持續產生收益。YT 產生的收益可以隨時提取。

### PT 和 YT 的交易特性

**PT（本金代幣）**：
- 相當於放棄了未來收益權的本金部分
- 出售時必然會以折扣價格出售
- 例如：1 DAI 按 PT 出售時，價格會比 1 DAI 便宜
- 購買並持有對應 PT 的人，可以保證到期之後換回 1 DAI
- 相當於一個固收類的產品

**YT（收益代幣）**：
- 相當於對未來收益權的一個投機
- 例如：某個 YT 的價格是 0.04 DAI，但持有 1 年產生的收益是 0.05 DAI
- 這個過程中投資回報為 25%

## 流動性引擎

流動性引擎（Liquid Engine）是 Pendle 用來把各種質押資產（比如 stETH、ezETH、sfrxETH 等）的收益權拆分、再打包並釋放流動性的機制。

Pendle 的自動做市商（AMM）是一個專為處理「隨時間衰減資產」而設計的交易引擎。這意味著它能夠處理那些價值會隨著時間推移而變化的資產，例如收益代幣（Yield Token, YT）和本金代幣（Principal Token, PT）。

### 購買 YT 的流程

如果你有一筆資產，想要購買 YT，流程如下：
1. Pendle 會把你的資產換算成 SY
2. 接著在 PT 和 SY 的池子中借出 SY
3. 分解 SY 從而生成 YT 和 PT
4. 將需要的 YT 發送給你
5. 然後剩下的 PT 賣給池子從而償還借出來的 SY

### 出售 YT 的流程

如果要出售 YT，邏輯是類似的：
1. 首先從 PT 和 SY 池子中借出 PT
2. 然後將 YT 和 PT 合成出 SY
3. 對應的 SY 份額發送給用戶
4. 剩下的 SY 賣給池子，償還開始借出來的 PT

### 提供流動性

上述是交易的邏輯，我們還可以給流動性池子添加流動性，從而賺取交易手續費。但是和一般的流動性池子不同點的是，Pendle 添加的流動性資產有到期的說法。

一般的 AMM 比如 Uniswap，如果向 LP 提供流動性，就可以放在池子中始終不用管。但是 Pendle 提供的流動性方式會有一些不同，具體來說向 Pendle 池子中提供流動性有如下特點：

- **時間敏感的定價模型**：Pendle 的 AMM 會根據資產的到期時間調整價格。隨著到期日的臨近，PT 的價格會逐漸接近其基礎資產的價值，而 YT 的價值則會減少。
- **動態曲線調整**：與傳統的恆定乘積模型不同，Pendle 的 AMM 會根據時間和市場條件動態調整其定價曲線，以更準確地反映資產的實際價值。

另外傳統的 LP 在交易過程中可能會對流動性提供者造成一定程度的無常損失，但是 Pendle 在這方面有很大的不同。提供流動性初期短期內仍可能有輕微的無常損失，但如果流動性提供者持有到期，**無常損失將歸零**，因為 PT 和 SY 在到期時價值完全相等。

## 實際案例分析

### Case 1：初始流動性與價格變化

假設 Alice 有 100 USDC 然後向池子添加流動性，他所添加的流動性會被轉換成對應的 PT 和 YT。初始情況假設 Bob 購買了 40 YT 以及 Carol 購買了 60 YT。

現在假如說 cUSDC 價格上漲到了 1.2，此時價格變化情況是：

**Alice 目前的錢的情況**：
$$Alice = \frac{100}{1.2} = 83.33$$

**Bob 和 Carol 的收益計算公式**：
$$Interest = ytBalance(t*) \times (\frac{1}{SYIndex(t*)} - \frac{1}{SYIndex(t)})$$

具體而言：
$$Bob = 40 \times (\frac{1}{1} - \frac{1}{1.2}) = 6.667$$
$$Carol = 60 \times (\frac{1}{1} - \frac{1}{1.2}) = 10$$

如果把這三個數值加起來，會發現累加和依舊是 100 SY，也就是總量是不變的，但是收益關係會發生重新分配。

### Case 2：提取收益後的重新分配

如果此時 Carol 提取了 10 個他的收益，那麼目前池子的情況變化為新的狀態。如果再有新的獎勵分配，那麼分配規則是什麼樣的？

$$recordGenerate = i_u(t) - c_u(t) + \frac{ytBalance_u(t)}{SYIndex(t)}$$

**對於 Bob 而言**，他之前的收益沒有提取，所以新的收益分配比例對他而言是：
$$6.667 + \frac{40}{1.2} = 40$$

**對於 Carol 而言**，他之前的收益已經提取了，所以他的收益分配比例是：
$$0 + \frac{60}{1.2} = 50$$

對於 Bob 實際的新的 Reward 分配是：
$$rewards(Bob) = 90 \times \frac{40}{90} = 40$$

對於 Carol，他的分配是：
$$rewards(Carol) = 90 \times \frac{50}{90} = 50$$

### Case 3：價格繼續上漲

如果此時 cUSDC 的收益從 1.2 上漲到 1.3 了，Alice、Bob 和 Carol 的分配份額分別會是什麼樣的？

$$Alice = \frac{100}{1.3} = 76.923$$
$$Bob = 40 \times (\frac{1}{1.2} - \frac{1}{1.3}) = 2.564$$
$$Carol = 60 \times (\frac{1}{1.2} - \frac{1}{1.3}) = 3.846$$

算上之前的累積份額，再加上之前 Carol 提取的 10 SY，Alice + Bob + Carol 的總份額依舊總數是 100 SY。

### Case 4：到期後的領取風險

如果到期之後 cUSDC 價格上漲到了 1.4，而之前 Alice 一直沒有領取，那麼他如果現在要領取自己的 SY 的話，只能領取：
$$\frac{100}{1.4} = 71.428$$

讀到這裡，你可能會有疑惑，那他之前不是還有 76.923 個 SY 嗎？
$$76.923 - 71.428 = 5.495$$

這些剩下沒領的 SY 將來怎麼辦？結論是**直接歸 Pendle 所有**。所以如果到期的話，還是儘快把資金提取出來為好。

### 重要提醒

**SY 的價值能隨著時間推移後面降低嗎？**
答案是不行，因為隨著時間推移 YT 總是會產生收益，所以總的 SY 價值會越來越高。

---

> 本文整理自 Dapplearning 開源大學關於 Pendle 部分分享
> - 視頻內容詳情：[B站1](https://www.bilibili.com/video/BV1WC411G77T) | [Youtube1](https://www.youtube.com/watch?v=SQb9DLmWHWM&t=2450s)
> - [B站2](https://www.bilibili.com/video/BV11n4y1974n) | [Youtube2](https://www.youtube.com/watch?v=GOAty55-MMM)
> 
> 更多內容，歡迎來 Dapplearning 社區共同探討。
