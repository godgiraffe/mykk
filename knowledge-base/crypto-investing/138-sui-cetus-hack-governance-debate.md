# Sui 鏈凍結黑客資產事件：去中心化信仰的危機

> **來源**: [@c_luyishisi](https://x.com/c_luyishisi/status/1929439032741941428) | [原文連結](https://paragraph.com/@shisi-eth/bDvDEuPbh69WENsEbB5F)
>
> **日期**: Mon Jun 02 07:24:47 +0000 2025
>
> **標籤**: `區塊鏈治理` `協議升級` `去中心化危機`

---

![](../assets/crypto-investing/138-sui-cetus-hack-governance-debate-1.jpg)

> **來源**: [shisi.eth (@c_luyishisi)](https://twitter.com/c_luyishisi)
> **日期**: 2025-05-30
> **標籤**: `Sui` `Cetus` `去中心化` `治理爭議` `安全事件`

---

## 前言

這次的事件，是資本的勝利，而不是用戶的，對於行業發展更是一種倒退。

比特幣向左，Sui 向右，每一個動搖去中心化的行業舉動出現，都帶來更強烈對比特幣的信仰。

世界需要的不只是一套更好的全球化金融基礎設施，而是始終都會有一群人需要自由的空間。

曾幾何時，聯盟鏈是比公鏈更紅火的存在，就是因為他滿足那個時代的監管需求，如今聯盟的式微，其實也就是意味著單純遵從此需求，並不是真實用戶的需求，失去的被監管的用戶，那又需監管工具呢？

## 事件背景

2025 年 5 月 22 日，Sui 公鏈生態的最大去中心化交易所 (DEX) Cetus 遭遇黑客攻擊，瞬間流動性驟減,多種交易對價格崩塌，損失超過 2.2 億美元。

截止發稿前，時間線如下：

- **5 月 22 日上午**：黑客攻擊 Cetus 套取 2.3 億美元，Cetus 緊急暫停合約，發佈公告
- **5 月 22 日下午**：黑客跨鏈轉出約 6000 萬美元，其餘 1.62 億美元仍在 Sui 鏈上地址中，Sui 驗證節點迅速採取行動，將黑客地址加入「拒絕服務黑名單（Deny List）」，凍結資金
- **5 月 22 日晚間**：Sui CPO @emanabio 發推確認：資金已被凍結、歸還將很快開始
- **5 月 23 日**：Cetus 開始修復漏洞並更新合約
- **5 月 24 日**：Sui 開源 PR，解釋即將通過別名機制（aliasing）與 whitelist 進行資金回收
- **5 月 26 日**：Sui 啟動鏈上治理投票，提議是否執行協議升級、將黑客資產轉至託管地址
- **5 月 29 日**：投票結果公佈，超過 2/3 驗證節點權重支持；協議升級準備執行
- **5 月 30 日-6 月初**：協議升級生效，指定交易哈希被執行，黑客資產被「合法轉走」

## 攻擊原理

事件原理相關，行業已經有多篇表述，在此僅做核心原理概覽：

### 從攻擊流程上看

攻擊者首先利用閃電貸借出約 10,024,321.28 個 haSUI，瞬間將交易池的價格下跌了 99.90%。這一巨額賣單使得目標池價格從約 1.8956 × 10¹⁹ 降至 1.8425 × 10¹⁹，幾乎見底清空。

隨後,攻擊者在 Cetus 上以極窄的區間（Tick 下限 300000、上限 300200，區間寬度僅 1.00496621%）創建流動性頭寸。如此窄的區間放大了後續計算誤差對所需代幣數量的影響。

### 攻擊核心原理

在於 Cetus 用於計算所需代幣數量的 `get_delta_a` 函數中存在整數溢出漏洞。攻擊者故意聲明要添加一個巨大流動性（約 10³⁷ 單位），但實際只向合約中投入 1 個代幣。

由於 `checked_shlw` 的溢出檢測條件錯誤，合約在左移計算時發生了高位截斷，使得系統嚴重低估了所需的 haSUI 數量，從而以極小成本換取了巨量流動性。

### 從技術上看

上述漏洞源於 Cetus 在 Move 智能合約中使用了錯誤的掩碼和判斷條件，導致任何小於 `0xffffffffffffffff << 192` 的值都能繞過檢測；而左移 64 位後高位數據被截斷，系統僅收取極少代幣就認為獲得了巨大流動性。

在事件發生後,衍生出 2 個官方操作：「凍結」vs「追回」，他是兩個階段：
- 凍結階段靠 Deny List + 節點共識完成
- 追回階段則需鏈上協議升級 + 社區投票 + 指定交易執行繞過黑名單

## Sui 的凍結機制

Sui 鏈內本身就存在特殊的 Deny List（拒絕列表）機制，實現了本次黑客資金凍結。不止如此，其實 Sui 的代幣標準也有「受監管代幣」模式，帶有內置凍結功能。

此次應急凍結正是利用了這一特性：驗證者節點在本地配置文件中快速添加了被盜資金相關的地址。理論上每個節點運營者都可以自行修改 `TransactionDenyConfig` 來更新黑名單，但為了確保網絡一致性，Sui 基金會作為最初的配置發佈方進行了集中協調。

基金會首先官方發佈了含黑客地址的配置更新，驗證者按默認配置同步生效，從而讓黑客資金在鏈上暫時被「封印」，這背後實際上存在高度的集中化因素。

為了從凍結資金中解救受害者，Sui 團隊緊接著推出了白名單（Whitelist）機制補丁。

這是針對後續轉回資金的操作的。可以事先構造好合法交易並登記在白名單中，即便該資金地址還在黑名單上，也能強制執行。

這個新的特性 `transaction_allow_list_skip_all_checks` 允許將特定交易預先加入「免檢名單」，使這些交易可以跳過所有安全檢查，包括簽名、權限、黑名單等。

要注意的是，白名單補丁並不能直接搶走黑客資產；它只是賦予某些交易繞開凍結的能力，真正的資產轉移仍需合法簽名或額外系統權限模組來完成。

其實，行業主流的凍結方案往往發生在代幣合約層面，且由發行方多簽控制。

以 Tether 發行的 USDT 為例，其合約內置黑名單函數，發行公司可將違規地址凍結，使其無法轉移 USDT。這種方案需要多重簽名在鏈上發起凍結請求，多簽達成一致後才真正執行，因而存在執行延遲。

Tether 凍結機制雖然有效，但統計表明多簽流程常會出現「空窗期」，給不法分子留下可乘之機。

相比之下，Sui 的凍結發生在底層協議級別，由驗證者節點集體操作，執行速度遠快於普通合約調用。

這套模式下，要執行得夠快，就要意味著這些驗證者節點本身的管理，就是高度統一的。

## Sui 的「轉賬式回收」實現原理

更驚人的是，Sui 不僅凍結了黑客資產，還計劃通過鏈上升級「轉移回收」被盜資金。

5 月 27 日，Cetus 提出了社區投票方案，要求對協議進行升級，將被凍結的資金發送到多重簽名託管錢包中。Sui 基金會隨即發起鏈上治理投票。

5 月 29 日，公佈投票結果，約 90.9% 權重的驗證者支持該方案。Sui 官方宣布，一旦提案通過，「所有在兩個黑客賬戶中被凍結的資金將無需黑客簽名而被一併收回到一個多簽錢包」。

無需黑客簽名，這是多麼差異的特徵，從來區塊鏈行業都沒有這樣的修復方式。

從 Sui 官方的 GitHub PR 可知，協議引入了地址別名（address aliasing）機制。升級內容包括：在 `ProtocolConfig` 中預先指定別名規則，使得某些允許的交易可以將合法簽名視作來自黑客賬戶發送。

具體來說，將要執行的救援交易哈希列表與目標地址（即黑客地址）綁定，任何簽署並發佈這些固定交易摘要的執行者都被視為有效的黑客地址擁有者發起了交易。對這些特定交易，驗證者節點系統會繞過 Deny List 檢查。

從代碼層面看，Sui 在交易驗證邏輯中加入了如下判斷：當一筆交易被黑名單攔截後，系統遍歷其簽名者，檢查 `protocol_config.is_tx_allowed_via_aliasing(sender, signer, tx_digest)` 是否為真。

只要存在某個簽名者滿足別名規則，即標記這筆交易被允許通過，便忽略之前的攔截錯誤，繼續正常打包執行。

## 觀點

### 1.6 億，撕開的是行業最深的底層信仰

Cetus 事件，從筆者個人看來，這次或許風波會很快過去，但是這套模式不會遺忘，因為他顛覆了行業基礎，也打破了區塊鏈在同一套賬本下，不可篡改的傳統共識。

在區塊鏈設計裡，合約就是法律，代碼就是裁判。但這次事件中，代碼失效，治理干預，權力凌駕，形成了「投票行為裁決代碼結果」的模式。

就是因為，Sui 此次直接挪用交易的做法，與主流區塊鏈的處理黑客問題上有巨大差異。

### 這不是第一次「篡改共識」，但卻是最靜默的一次

從歷史上看：

以太坊 2016 年 The DAO 事件曾通過硬分叉回滾轉賬來彌補損失，但這一決定導致了以太坊與以太坊經典兩條鏈的分裂，過程備受爭議，但是最終是由不同的群體形成不同的共識信仰。

比特幣社區同樣經歷過類似技術挑戰：2010 年的價值溢出漏洞被開發者緊急修復並升級共識規則，徹底抹除了約 184 億枚非法生成的比特幣。

這都是同樣的硬分叉模式，把賬本回滾到問題之前，然後用戶依舊可以自行決定在哪套賬本體系下繼續使用。

與 DAO 硬分叉相比，Sui 沒有選擇分裂鏈條，而是通過協議升級加配置別名的方式精準針對本次事件。這樣做，Sui 保持了鏈的連續性和大部分共識規則不變，但同時也表明底層協議可以被用來實施針對性的「救援行動」。

問題就是，歷史上的「分叉式回滾」是用戶選擇信仰；Sui 的「協議式修正」是鏈替你做了決定。

### Not Your Key, Not Your Coin？恐怕 Not Anymore

從長遠看，這意味著「Not your keys, not your coins」的理念在 Sui 鏈上被瓦解：即便用戶私鑰完整，網絡仍可通過集體協議變更來阻止資產流動並重定向資產。

如果這成為未來區塊鏈應對大型安全事件的先例、乃至被認為是可以再次遵守的慣例。

「當一條鏈能為了正義打破規則，它也就有了打破任何規則的前例。」

一旦有一次「公益搶錢」的成功，下次就可能是「道德模糊地帶」的操作。

那會發生什麼？🧐

黑客是確實偷了用戶的錢，那麼群體投票，就可以搶走他的錢嗎？

投票依據的是誰的錢多（PoS）還是人多呢？錢多者勝利，那劉慈欣筆下的終產者將很快到來，如果是人多者勝利，那麼群體烏合之眾也就聲浪迭起。

在傳統制度下，非法所得不受保護是非常正常的，凍結與劃轉都是傳統銀行的常規操作。

但是從技術理論上無法進行這點，不就是區塊鏈行業的發展根源嗎。

現在行業合規的大棒在持續發酵，今天可以為了黑客凍結，修改賬戶餘額，那明天可以為地緣因素、矛盾因素，去做任意的修改。如果鏈成為地區性的部分工具。

那行業的價值也就被大幅壓縮，充其量就是另一套更不好用的金融系統而已。

這也是筆者堅定行業的原因：「區塊鏈不是因為不能凍結才有價值，而是因為即便你恨它，它也不為你改變。」

### 監管大勢所趨，鏈能否守住自己的靈魂？

曾幾何時，聯盟鏈是比公鏈更紅火的存在，就是因為他滿足那個時代的監管需求，如今聯盟的式微，其實也就是意味著單純遵從此需求，並不是真實用戶的需求，失去的被監管的用戶，那又需監管工具呢。

### 從行業發展角度看📶

「高效的中心化」，它是區塊鏈發展的必經階段嗎？如果去中心化的最終目標是保障用戶利益，那我們能否容忍中心化作為過渡手段？

「民主」這個詞，在鏈上治理語境中，其實是 token weighted 的。那麼黑客如果持有大量 SUI（或某天 DAO 被黑，黑客控制票權），是否也可以「合法投票洗白自己」？

最終，區塊鏈的價值，不在於能不能凍結，而在於即便群體有能力凍結，也選擇不這麼做。

一條鏈的未來，不由技術架構決定，而由它選擇守護的那套信仰來決定。🤠
